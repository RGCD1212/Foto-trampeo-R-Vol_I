---
output:
  pdf_document: default
  html_document: default
---


# Curvas de acumulación: `BiodiversityR`

### *Luz A. Pérez-Solano* {-}

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(imager)
library(kableExtra)
library(xtable)
```

## Introducción

Uno de los principales objetivos en los estudios ecológicos es conocer cuántas especies habitan en cierta área [@Moreno2011]. Es decir, cuando trabajamos con cámaras-trampa interesa conocer si las especies que aparecen en las fotos son todas las que habitan en el sitio de estudio. Por supuesto, con este método solo es posible identificar confiablemente a mamíferos y aves de talla mediana y grande. Por el contrario, mamíferos muy pequeños como los ratones y por supuesto los murcíelagos no son identificables con este método. Para tal caso, se deben emplear complementariamente varios métodos de muestreo, como por ejemplo las trampas sherman para ratones, redes para murciélagos, avistamientos directo de los animales y de sus rastros, como huellas y excretas. 

\pagebreak

Uno de los métodos que se comenzó a utilizar con más frecuencia para conocer la riqueza de especies total de una comunidad fueron las curvas de acumulación de especies. Estas curvas muestran el número de especies acumuladas conforme se va aumentando el esfuerzo de recolecta en un sitio, de tal manera que la riqueza aumentará hasta que llegue un momento en el cual por más que se recolecte, el número de especies alcanzará un máximo y se estabilizará en una asíntota. La idea central se presenta en la figura 
\@ref(fig:e1).

```{r e1, echo=FALSE, message=FALSE, warning=FALSE, fig.cap= "Ejemplo de la relación esfuerzo de muestreo y número de especie. (Basado en Escalante, 2013).", fig.align='center', out.width= "75%"}
F1<- load.image('Fig1.png')
plot(F1, axes= F)
```

El objetivo del presente capítulo es presentar el proceso para construir curvas de acumulación de especies a partir de registros obtenidos en cámaras-trampa, empleando el paquete `Biodiversity` desarrollado por Kindt y Coe (2005). 

## Descripción del paquete

Este paquete proporciona una Interfaz Gráfica de Usuario (en inglés GUI - *Graphical User Interface*, a través del R-Commander) y algunas funciones de utilidad (a menudo basadas en el paquete `vegan`) para análisis estadísticos de biodiversidad y comunidades ecológicas, incluyendo curvas de acumulación de especies, índices de diversidad, perfiles de Renyi, MLGs para el análisis de abundancia de especies y presencia-ausencia, matrices de distancia, pruebas de Mantel, y clúster, análisis de ordenación restringida y no restringida. Un libro sobre biodiversidad y análisis de ecología de la comunidad está disponible para su descarga gratuita desde el sitio web.

El PDF con la viñeta del paquete se puede bajar desde: <https://cran.r-project.org/web/packages/BiodiversityR/BiodiversityR.pdf>

Se sugiere además consultar la publicación original por Kindt y Coe (2005): <http://www.worldagroforestry.org/output/tree-diversity-analysis>

## Proceso

Instalar la siguiente librería:

```{r, message=FALSE, warning=FALSE}
library(BiodiversityR)
```

Cargar la matriz de datos previamente creada en Excel y se muestra los nombres de las especies de mamíferos contenidas en ese archivo:

```{r, linewidth=45}
mamiferos <- read.csv("mamiferos.csv", header=T, 
                      row.names=1)
names(mamiferos)
```

Cada columna de la matriz son los registros independientes de 13 especies de mamíferos medianos y grandes en 9 cámaras-trampa, las cuales serán usadas como medida de esfuerzo de muestreo (Cuadro \@ref(tab:e2)). 

```{r e2, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
knitr::kable(t(mamiferos), caption = "Especies fotografiadas en cada cámara-trampa en el sitio de estudio. Nota: para fines de presentación, en esta tabla los renglones y columnas se han puesto en orden inverso o transpuesto.") 
```

A continuación se generan tres tipos de curvas de acumulación mediante la función `accumresult`. La primera es la curva de acumulación de especies mediante el método `collector`. Este método agrega las especies registradas en el orden en que aparecen las cámaras o sitios en los datos (Figura \@ref(fig:e3)a). La segunda curva estima la riqueza de especies esperada promedio y el error estándar mediante el método `exact` (Figura \@ref(fig:e3)b). La tercer curva mediante el método `coleman` encuentra la riqueza esperada de acuerdo con @Coleman1982 (Figura \@ref(fig:e3)c).   

```{r e3, echo=TRUE, fig.align='center', fig.cap="Diferentes curvas de acumulación", fig.height=11, fig.width=9, message=FALSE, warning=FALSE}
mamiferos1 <- accumresult(mamiferos, method = "collector")
mamiferos2 <- accumresult(mamiferos, method="exact")
mamiferos3 <- accumresult(mamiferos, method="coleman")
par(mfcol = c(2,2))
plot(mamiferos1, las = 1, lwd = 2, col = "red", 
     frame.plot = F, main = "a) Collector")
plot(mamiferos2, las= 1, lwd = 2, col= "red", 
     frame.plot = F, main = "b) Exact")
plot(mamiferos3, las= 1, lwd = 2, col= "red", 
     frame.plot = F, main = "c) Coleman")
```

Existe otro método que es `rarefaction` el cual encuentra la media al acumular individuos en lugar de sitios. Para este ejemplo no se cuenta con identificación de individuos, por lo cual se ha omitido. De igual forma, la función `accumresult` permite estimar la riqueza dada alguna covariable a través del argumento `factor`; para ésta y más funciones, sugerimos revisar el manual del paquete `BiodiversityR`.

## Gráfico final

En los siguientes códigos del gráfico se muestra cómo cambian los intervalos de confianza de acuerdo al estilo elegido (Figura \@ref(fig:e4)).

```{r e4, echo=TRUE, fig.align='center', fig.cap="Ejemplo de curvas de acumulación con diferentes estilos de intervalos de confianza.", fig.height=5, message=FALSE, warning=FALSE}
mamiferos_2 <- accumresult(mamiferos, method="exact")
plot(mamiferos2, ci.type = "polygon", ylim = c(0,15), 
     xlim = c(1,9), lwd = 2, ci.lty = 0, 
     ci.col = "gray80", last = 1, frame.plot = F, 
     pch = 16, cex.lab = 1, cex.axis = 1, col = "red", 
     las = 1, main = "Mamíferos", 
     xlab = "No. de cámaras", ylab = "Especies")
```

Para exportar la imagen anterior en formato `.jpg` se sugiere emplear la función:

```
jpeg(filename = "Curvas_acumulacion.jpg", width = 8000, 
  height = 7000, units = "px", res = 1200)

dev.off()
```

## Interpretación de resultados

Las curvas de acumulación de especies es una representación gráfica del número de especies presentes en el sitio de estudio en función de alguna medida del esfuerzo de muestreo, como por ejemplo el área muestreada, los días de muestreo u otro. Frecuentemente, este tipo de gráficos muestra que conforme aumenta el esfuerzo de muestreo el número de especies muestreadas o fotografiadas va aumentando primero rápido y después se estabiliza. Este punto se conoce como asíntota y se considera que se ha muestreado o detectado al mayor número de especies. Se sugiere ampliamente profundizar en los conceptos y métodos de análisis más detallados sobre este parámetro comunitario que es la riqueza de especies. Por ejemplo los trabajos de Colweel (2016), @Moreno2001, por mencionar solo algunos.

## Sumario

En este capítulo se mostró de manera muy sencilla el proceso para construir curvas de acumulación empleando el paquete `Biodiversity` desarrollado por Kindt y Coe (2018). Estas curvas muestran el número de especies acumuladas conforme se va aumentando el esfuerzo de recolecta en un sitio, de tal manera que la riqueza aumentará hasta que llegue un momento en el cual por más que se recolecte, el número de especies alcanzará un máximo y se estabilizará en una asíntota. De manera que este capítulo puede ser muy útil para los monitoreos de especies.


