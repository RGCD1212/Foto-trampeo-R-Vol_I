---
output: pdf_document
---

# Simulación de movimientos y efectos en la detección: `sim_JK`

### *Salvador Mandujano* {-}

## Introducción

Una pregunta frecuente durante el diseño del muestreo es ¿cuál es la distancia óptima entre cámaras-trampa? No hay una respuesta sencilla. Frecuentemente la decisión se toma basado en el conocimiento que se tiene acerca de las distancias de desplazamiento o del ámbito hogareño de la especie de interés. Si el animal se mueve grandes distancias, entonces las cámaras se colocan separadas varios kilómetros unas de otras. Si la distancia de desplazamiento es pequeña, entonces la distancia entre cámaras será de unos cientos de metros. Algunos equipos de trabajo sugieren una separación promedio de 2 km entre cámaras para maximar la captura de fotos de cualquier especie habitando el sitio de estudio. La finalidad última es tratar de detectar al mayor número posible de individuos que habitan en el área de estudio. Aunque este libro se centra en el empleo de cámaras-trampa, en realidad este es un problema o pregunta asociada a cualquier otro método de muestreo como por ejemplo redes, trampas, transectos, estaciones olfativas, entre algunos.

La detección de los individuos de la especie de interés dependerá de varios factores: 

1. _Inherentes al animal_: por ejemplo la distancia de desplazamiento promedio al día, tamaño promedio del ámbito hogareño, selección y preferencias de hábitat, patrones diurnos de actividad, abundancia poblacional, entre los principales. 

2. _Inherentes al hábitat_: visibilidad, caminos, recursos como agua y alimento, época del año, entre algunos. 

3. _Inherentes al muestreo_: modelo de cámaras, número de cámaras, distancia entre las mismas, tiempo (días) de muestreo, entre los principales.

Para ejemplificar cómo la variación en los movimientos de los animales, aquí llamado HR de las siglás en inglés de ámbito hogareño ("home-range") y de la abundancia de individuos (N), pueden afectar su detección dependiendo además de la distancia entre las cámaras-trampa, en este capítulo se presenta una aproximación basada en simulaciones llamada "*Random Walker*" o caminata aleatoria. Los resultados de estas simulaciones pueden apoyar la decisión del espaciamiento.

## Escenarios simulados

Para responder a la pregunta inicial de este trabajo, se consideran los siguientes parámetros: 

1. dos tamaños de ámbito hogareño: *HR* = 100 y *HR* = 1000 unidades de superficie (podrían ser hectáreas o kilómetros cuadrados); 

2. dos abundancias: *N* = 1 y *N* = 10; y 

3. dos tamaños de retículas o grillas con 100 cámaras-trampa cada una y con diferente distancia de separación entre las mismas: *grid1* = 100 y *grid2* = 500 (podrían ser metros). 

La combinación de estos tres parámetros (HR, N y retícula) da como resultado la simulación de ocho posibles escenarios.

## Paquete `sim_JW`

Para realizar las simulaciones, se creo el paquete `sim_JW` (simulador Johny Walker) el cual consiste de solo dos funciones: `JW` y `muestreo` (Mandujano, en preparación). El primero es un simulador de caminata aleatoria en el que se supone un proceso tipo Poisson; es decir, tanto los movimientos de los individuos, como la distribución de los mismos en el sitio de muestreo, son aleatorios. Mientras que el segundo sirve para definir el tamaño de la retícula y sobreponer los movimientos de los animales.

La función caminata aleatoria es:

```{r echo=TRUE, message=FALSE, warning=FALSE}
JW <- function(x, y, HR) {
  for (j in 1:N) {
    x <- runif(1,1,99)
    y <- runif(1,1,99)
  points(x,y,pch=16,col="black",cex=1.2)
  for (i in 1:HR) {
    xi <- sample(c(1,0,-1),1) 
    yi <- sample(c(1,0,-1),1) 
    points(c(x, x + xi), c(y, y + yi), pch = 16, 
           cex = 0.3, col = "blue") 
    x <- x + xi
    y <- y + yi
    if (x > 100 | x < 0 | y > 100 | y < 0) break  
    }
  } 
}
```

\pagebreak

Mientras que la función retícula de muestreo es:

```{r echo=TRUE, message=FALSE, warning=FALSE}
muestreo <- function(reticula) {
par(mfrow = c(1,1), mar = c(3,5,3,5))
plot(0:100, 0:100, type = "n", 
     xlab = "UTM", ylab = "UTM") 
points(reticula, pch = 3, col = "red", cex = 0.1) 
}
```

## Datos

Para simular la caminata aleatoria, se debe introducir los datos con coordenadas xy de cada cámara en la retícula. Luego se leen los datos de cada retícula de muestreo como:

```{r echo=TRUE, message=FALSE, warning=FALSE}
grid1 <- read.csv("grid1.csv", header = T)
grid2 <- read.csv("grid2.csv", header = T)
```

Gráficamente las retículas se muestran en la Figura (\@ref(fig:z1)). Note que la retículas con 100 cámaras y separadas a distintas distancias o unidades espaciales (100 y 500 en esta simulación), es solo para ejemplificar. Se sugiere repetir estas simulaciones con diferente número de cámaras y distancias. En este ejemplo, las unidades espaciales carecen de medida métrica pero se podrían emplear UTMs para simular un contexto espacial.

```{r z1, echo=FALSE, message=FALSE, warning=FALSE, fig.height=6, fig.width=3, fig.cap="Ejemplos de dos grids o retículas de muestreo con 100 cámaras pero espaciadas a diferente distancia. Se muestran a la misma escala para que se perciba el distanciamiento entre cámaras. El círculo indica el área potencial de detección.", fig.align='center'}
par(mfcol = c(2,1))
plot(grid1, xlim = c(19,71), ylim = c(19,71), frame.plot = F, main = "Retícula 1 espaciadas 100 m", col = "red", cex = 0.1)
plot(grid2, xlim = c(19,71), ylim = c(19,71), frame.plot = F, main = "Retícula 2 espaciadas 500 m", col = "red")

```

En las simulaciones que a contiuación se presentan, el centro de actividad del animal en un punto negro y los movimientos dentro del ámbito hogareño en color azul claro (Figura \@ref(fig:z2)). Por su parte, las unidades de muestreo dentro de la retícula se presentan en un círculo de color rojo. La detección solo sucede cuando el animal toca o entra dentro de este círculo (ver Capítulo 1).

```{r z2, echo=FALSE, fig.align='center', fig.cap="Ejemplo de un escenario de simulación de movimientos de 10 animales que se mueven poco y solo son detectados (fotografiado) aquellos individuos que entran en el área de acción de las cámaras-trampa.", fig.height=5, fig.width=6, message=FALSE, warning=FALSE}
N <- 10; HR <- 100; reticula <- grid1
muestreo(reticula); JW(x, y, HR)
```

## Ejemplo 1

Para este primer ejemplo las simulaciones se basan en la combinación de los siguientes valores de los tres parámetros:

- __Caso 1A__: Abundancia muy baja (*N* = 1), ámbito hogareño pequeño (*HR* = 100) y una reticula de muestreo pequeña.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 1; HR <- 100; reticula <- grid1
muestreo(reticula); JW(x, y, HR)
```

- __Caso 1B__: Abundancia alta (*N* = 10), ámbito hogareño pequeño (*HR* = 100) y una reticula de muestreo pequeña.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 10; HR <- 100; reticula <- grid1
muestreo(reticula); JW(x, y, HR)
```

- __Caso 1C__: Abundancia alta (*N* = 1), ámbito hogareño grande (*HR* = 1000) y una reticula de muestreo pequeña.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 1; HR <- 1000; reticula <- grid1
muestreo(reticula); JW(x, y, HR)
```

- __Caso 1D__: Abundancia alta (*N* = 10), ámbito hogareño grande (*HR* = 1000) y una reticula de muestreo pequeña.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 10; HR <- 1000; reticula <- grid1
muestreo(reticula); JW(x, y, HR)
```

## Ejemplo 2

En este ejemplo la retícula de muestreo las cámaras están separadas a mayor distancia:


- __Caso 2A__: Abundancia muy baja (*N* = 1), ámbito hogareño pequeño (*HR* = 100) y una reticula de muestreo grande.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 1; HR <- 100; reticula <- grid2
muestreo(reticula); JW(x, y, HR)
```

- __Caso 2B__: Abundancia alta (*N* = 10), ámbito hogareño pequeño (*HR* = 100) y una reticula de muestreo grande.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 10; HR <- 100; reticula <- grid2
muestreo(reticula); JW(x, y, HR)
```

- __Caso 2C__: Abundancia alta (*N* = 1), ámbito hogareño grande (*HR* = 1000) y una reticula de muestreo grande.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 1; HR <- 1000; reticula <- grid2
muestreo(reticula); JW(x, y, HR)
```

- __Caso 2D__: Abundancia alta (*N* = 10), ámbito hogareño grande (*HR* = 1000) y una reticula de muestreo grande.

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.width=3.5, fig.height=2.5, fig.align='center'}
N <- 10; HR <- 1000; reticula <- grid2
muestreo(reticula); JW(x, y, HR)
```

## Simulación general

En los ejemplos anteriores se simuló solo una vez cada uno de los excenarios posibles (casos 1A-1D y casos 2A-2D). Sin embargo, si se quiere tener un patrón general se puede simular cada uno *n* veces. Por ejemplo, 100 veces y se simula dos casos a continuación:

\pagebreak

**Ejemplo 1 Caso 1A**

```{r z11, echo=FALSE, message=FALSE, warning=FALSE, out.width="75%", fig.align='center'}
knitr::include_graphics("/Users/SMandujanoR/Documents/LaTex/Libros/ebook Foto-trampeo/Libro/Vol I/Cap_juanito/sim1.png") 
```

**Ejemplo 2 Caso 2B**

```{r z12, echo=FALSE, message=FALSE, warning=FALSE, out.width="75%", fig.align='center'}
knitr::include_graphics("/Users/SMandujanoR/Documents/LaTex/Libros/ebook Foto-trampeo/Libro/Vol I/Cap_juanito/sim2.png") 
```

## Gráfico final

Si esto se hace para los ocho excenarios planteados en este trabajo y cada uno se simula 100 veces, se puede obtener la frecuencia de detecciones para cada uno (Figura \@ref(fig:z13)).

```{r z13, echo=FALSE, message=FALSE, warning=FALSE, out.width="75%", fig.align='center'}
knitr::include_graphics("/Users/SMandujanoR/Documents/LaTex/Libros/ebook Foto-trampeo/Libro/Vol I/Cap_juanito/nsimulaciones.png")
```

Con base en los resultados de estas simulaciones se puede concluir lo siguiente:

- Si la abundancia de la población es baja la detección de los individuos en las unidades de muestreo es baja.

- Si el ámbito hogareño de los animales es pequeño, la detección de los mismos en las unidades de muestreo, es baja.

- Conforme aumenta la abundancia y el tamaño del ámbito hogareño, se detectan un mayor número de individuos.

- Si las unidades de muestreo están más espaciadas en el área de estudio, aumenta la probabilidad de detectar a los individuos.

## Sumario

En este capítulo se respondió a la pregunta ¿cuál es la distancia óptima entre cámaras-trampa? Para este fin, y como muchos casos en ecología, se emplearon modelos de simulación sencillos en los que se consideraron tres parámetros: el tamaño de desplazamiento de los animales, el número de animales en el sitio de estudio y la distancia entre las cámaras. El paquete `sim_JW` permite simular los escenarios que se deseen. Se sugiere aplicarlo a datos de premuestreos en el sitio de estudio. Aunque la retícula en los ejemplos analizados fue de 100 cámaras equidistantes entre sí, se podrían introducir otros diseños de muestreo.  

